unit UnitModificarTime;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, UnitCadastrarTime, DB, ADODB, StdCtrls, ExtCtrls, DBCtrls, Mask,
  Buttons, jpeg;

type
  TFormModificarTime = class(TFormCadastrarTime)
    DBNavigator1: TDBNavigator;
    procedure BitBtnCadastrarClick(Sender: TObject);
    procedure BitBtnSairClick(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure BitBtnLimparClick(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FormModificarTime: TFormModificarTime;

implementation

{$R *.dfm}

procedure TFormModificarTime.BitBtnCadastrarClick(Sender: TObject);
begin
  If TBLTimes.State = dsEdit // Se ouve alguma modificação nos Edits
  Then If (DBEdit1.Text='') Then //Verifica se os Edit de Nome do Time esta vazio
    Begin
      ShowMessage('Favor verificar se o Nome do time foi digitado!');
      DBEdit1.SetFocus;
    End
  Else if (DBEdit2.Text='    - ') Then //Verifica se os MaskEdit do Código esta vazio
    Begin
      ShowMessage('Favor verificar se o Código foi digitado!');
      DBEdit2.SetFocus;
    End
  Else
    Begin
      TBLTimes.Post; // Atualiza o registro atual do BD
      ShowMessage('Moficado com sucesso!');
      TBLTimes.Active:=False;
      TBLTimes.Active:=True;
    End;
end;

procedure TFormModificarTime.BitBtnSairClick(Sender: TObject);
begin
  close;
end;

procedure TFormModificarTime.FormClose(Sender: TObject;
  var Action: TCloseAction);
begin
  If TBLTimes.State = dsEdit // Se ouve alguma modificação nos Edits
  Then If MessageDlg ('Salvar modificações?', mtConfirmation, mbOkCancel,0) = mrOk
  Then If (DBEdit1.Text='') Then //Verifica se os Edit de Nome do Time esta vazio
    Begin
      ShowMessage('Favor verificar se o Nome do time foi digitado!');
      DBEdit1.SetFocus;
      Abort;
    End
  Else if (DBEdit2.Text='    - ') Then //Verifica se os MaskEdit do Código esta vazio
    Begin
      ShowMessage('Favor verificar se o Código foi digitado!');
      DBEdit2.SetFocus;
      Abort;
    End
  Else
    Begin
      TBLTimes.Post; //Salva o registro atual na base de dados do ADOTable
      ShowMessage('Modificado com sucesso!');
    End;
  TBLTimes.Cancel; //Cancela as modificações feitas na base de dados do ADOTable através do formulário e limpa os campos
  TBLTimes.Active:=False; //Desativa a base de dados do ADOTable
end;

procedure TFormModificarTime.BitBtnLimparClick(Sender: TObject);
begin
If TBLTimes.State = dsEdit
  Then If MessageDlg ('Desfazer modificações não salvas?', mtConfirmation, mbOkCancel,0) = mrOk
	Then
    Begin
      TBLTimes.Cancel;
      ShowMessage('Moficações desfeitas!');
    End;
end;

procedure TFormModificarTime.FormShow(Sender: TObject);
begin
  TBLTimes.Active:=True;
end;

procedure TFormModificarTime.FormCreate(Sender: TObject);
begin
  DeleteMenu(GetSystemMenu(Handle, False), SC_MOVE, MF_BYCOMMAND);
end;

end.


